@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>Xtendable Exports</h1>
    <p class="lead">We provide the ability to generate custom exports of account information meeting a given set of criteria.</p>
    <p>Use our incredible export wizard creator below OR</p>
    <p>Choose from a premade exports!</p>
</div>

<div class="row">
    <select id="PremadeExports"></select>
</div>
@section Scripts
{
    <script>
        fillDropDown('/Home/GetPremadeExports', $('#PremadeExports'))
        function fillDropDown(url, dropDownElement) {
            $.ajax({
                url: url,
                dataType: 'json',
                async: false,
                success: function (result) {
                    dropDownElement.empty();
                    if (result.length == 0) {
                        dropDownElement.append($('<option/>', {
                            value: ''
                        }).html('No Premades Saved'));
                    } else {
                        dropDownElement.append($('<option/>', {
                            value: ''
                        }).html('Premade Exports'));
                                        $(result).each(function () {

                            dropDownElement.append(
                                $('<option/>', {
                                    value: this.id
                                }).html(this.Name));
                        } else if ($(dropDownElement).attr('id') == 'specialtyGroupSelect') {
                            dropDownElement.append($('<optgroup/>', { label: this.Name + '(' + this.Code + ')' })); //.html(this.Name + ' (' + this.Code + ')'));

                            for (var i = 0; i < this.Specialties.length; i++) {
                                dropDownElement.append($('<option/>', { value: this.Specialties[i].Key }).html(this.Specialties[i].Name + ' (' + this.Specialties[i].Code + ')'));
                            };
                        } else {
                            dropDownElement.append(
                            $('<option/>', {
                                value: this.Code
                            }).html(this.Name));
                        }
                    });
        },
        error: function (jqXHR, error) {
            dropDownElement.empty();
            if ($(dropDownElement).attr('id') == 'specialtyGroupSelect') {
                $("#specialtyGroupSelect").select2('destroy');
            }
            dropDownElement.append($('<option/>', {
                value: '',
                selected: 'selected'
            }).html('** API ERROR - COULD NOT RETRIEVE VALUES **'))
                .addClass('ddError')
                .removeAttr('multiple');

        }
        });
        }
    </script>
}